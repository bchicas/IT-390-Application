<!DOCTYPE html>
<!-- Website Template by freewebsitetemplates.com -->
<html>
  <head>
    <meta charset="UTF-8" />
    <title>BookWorm</title>
    <link rel="stylesheet" href="css/style.css" type="text/css" />
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script
      type="module"
      src="https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js"
    ></script>

    <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
    <script
      type="module"
      src="https://www.gstatic.com/firebasejs/9.19.1/firebase-analytics.js"
    ></script>

    <!-- Add Firebase Authentication -->
    <script
      type="module"
      src="https://www.gstatic.com/firebasejs/9.19.1/firebase-auth.js"
    ></script>

    <!-- Add FirebaseUI -->
    <script
      type="module"
      src="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.js"
    ></script>
    <link
      type="text/css"
      rel="stylesheet"
      href="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.css"
    />
  </head>
  <body>
    <div id="page">
      <div id="header">
        <a href="index.html" class="logo"
          ><img src="images/bookworm.png" alt=""
        /></a>
        <div class="navigation">
          <ul class="primary">
            <li class="selected">
              <a href="index.html">home</a>
            </li>
            <li>
              <a href="about.html">about</a>
            </li>
          </ul>
          <ul class="secondary">
            <li>
              <a href="browse.html">browse</a>
            </li>
            <li>
              <button id="google-sign-in-btn">Sign in with Google</button>
            </li>
          </ul>
        </div>
      </div>
      <div id="firebaseui-auth-container"></div>
      <div id="body">
        <div class="header">
          <img src="images/welcome.png" alt="" />
        </div>
        <div class="body">
          <div class="bookdisplay">
            <h2><a href="browse.html">top books this week</a></h2>
            <ul>
              <li>
                <a href="ViewABook.html"
                  ><img src="images/happy-days.jpg" alt=""
                /></a>
              </li>
              <li>
                <a href="ViewABook.html"
                  ><img src="images/tourist.jpg" alt=""
                /></a>
              </li>
              <li>
                <a href="ViewABook.html"
                  ><img src="images/out-fairytale.jpg" alt=""
                /></a>
              </li>
              <li>
                <a href="ViewABook.html"
                  ><img src="images/philip.jpg" alt=""
                /></a>
              </li>
            </ul>
          </div>
        </div>
        <br />
        <br />
        <div class="body">
          <div class="bookdisplay">
            <h2><a href="browse.html">recommended for you</a></h2>
            <ul id="recommendedBooksList"></ul>

            <script>
              // User's favorite genre
              const userGenre = "Fiction";

              // Function to get book recommendations based on user's favorite genre
              function getRecommendations() {
                const recommendedBooks = [];
                const apiUrl = `https://openlibrary.org/subjects/${userGenre.toLowerCase()}.json?limit=4`; // API endpoint for genre-based books
                fetch(apiUrl)
                  .then((response) => response.json())
                  .then((data) => {
                    const books = data.works;
                    for (let i = 0; i < books.length; i++) {
                      const title = books[i].title;
                      const coverId = books[i].cover_id;
                      const coverUrl = `https://covers.openlibrary.org/b/id/${coverId}-M.jpg`; // Book cover image URL
                      recommendedBooks.push({ title, coverUrl }); // Store title and coverUrl as an object
                    }
                    displayRecommendations(recommendedBooks); // Call displayRecommendations() with the array of recommended books
                  })
                  .catch((error) => console.error("Error:", error));
              }

              // Function to display book recommendations with cover images and titles
              function displayRecommendations(recommendedBooks) {
                const recommendedBooksList = document.getElementById(
                  "recommendedBooksList"
                ); // Get the <ul> element
                recommendedBooks.forEach((book) => {
                  const listItem = document.createElement("li");
                  const link = document.createElement("a");
                  const img = document.createElement("img");
                  const title = book.title;

                  // Split the title at space characters
                  const words = title.split(/\s+/);

                  // Check the length of each word and append to DOM
                  let line1 = "";
                  let line2 = "";
                  for (let i = 0; i < words.length; i++) {
                    if ((line1 + words[i]).length <= 15) {
                      line1 += words[i] + " ";
                    } else {
                      line2 += words[i] + " ";
                    }
                  }

                  // Create two lines for the title using <br> element
                  const titleElement = document.createElement("h4");
                  titleElement.innerHTML = line1.trim() + "<br>" + line2.trim();

                  link.href = "ViewABook.html";
                  img.src = book.coverUrl;
                  img.alt = "";
                  link.appendChild(img);
                  listItem.appendChild(link);
                  listItem.appendChild(titleElement); // Append title element
                  recommendedBooksList.appendChild(listItem);
                });
              }

              // Get book recommendations for the user
              getRecommendations();
            </script>
          </div>
        </div>
      </div>
      <div id="footer">
        <p>
          Copyright Team 4 2023 | This page does not gather any personal
          information
        </p>
      </div>
    </div>
  </body>
</html>
